{% load static %}
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Leonis Anime Shop{% endblock %}</title>
    <script>
        // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        (function() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
        })();
    </script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root[data-theme="light"] {
            --primary-color: #FF6B4A;
            --secondary-color: #2C3E50;
            --accent-color: #FFD700;
            --background-color: #FFF9F5;
            --card-bg: #FFFFFF;
            --text-color: #333333;
            --text-muted: #666666;
            --border-color: rgba(0,0,0,0.1);
            --hover-color: rgba(255,107,74,0.1);
            --heading-color: #2C3E50;
        }

        :root[data-theme="dark"] {
            --primary-color: #FF6B4A;
            --secondary-color: #A0AEC0;
            --accent-color: #FFD700;
            --background-color: #1A1A1D;
            --card-bg: #2D2D32;
            --text-color: #E2E8F0;
            --text-muted: #A0AEC0;
            --border-color: rgba(255,255,255,0.1);
            --hover-color: rgba(255,107,74,0.2);
            --heading-color: #E2E8F0;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            transition: background-color 0.3s, color 0.3s;
        }

        [data-theme="light"] body {
            background-image: url('data:image/svg+xml,<svg width="30" height="30" viewBox="0 0 30 30" xmlns="http://www.w3.org/2000/svg"><rect width="30" height="30" fill="%23FFF9F5"/><path d="M15,15 L16,16 Q17,17 15,17 Q13,17 14,16 Z" fill="%23FFE5D9"/></svg>');
        }

        [data-theme="dark"] body {
            background-image: url('data:image/svg+xml,<svg width="30" height="30" viewBox="0 0 30 30" xmlns="http://www.w3.org/2000/svg"><rect width="30" height="30" fill="%231A1A1D"/><path d="M15,15 L16,16 Q17,17 15,17 Q13,17 14,16 Z" fill="%23333"/></svg>');
        }

        .navbar {
            background-color: var(--card-bg) !important;
            box-shadow: 0 2px 8px var(--border-color);
            padding: 0.5rem 1rem;
        }

        .navbar-brand {
            font-family: 'Noto Sans JP', sans-serif;
            font-weight: 700;
            color: var(--primary-color) !important;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .navbar-brand img {
            width: 40px;
            height: 40px;
            transition: transform 0.5s cubic-bezier(0.68, -0.6, 0.32, 1.6);
            transform-origin: bottom center;
        }

        .navbar-brand:hover img {
            animation: pandaJump 0.7s ease-in-out;
        }

        @keyframes pandaJump {
            0% {
                transform: translateY(0) rotate(0);
            }
            25% {
                transform: translateY(-15px) rotate(-8deg);
            }
            35% {
                transform: translateY(-15px) rotate(8deg);
            }
            45% {
                transform: translateY(-15px) rotate(-8deg);
            }
            55% {
                transform: translateY(-15px) rotate(8deg);
            }
            75% {
                transform: translateY(-5px) rotate(0);
            }
            85% {
                transform: translateY(-2px);
            }
            92% {
                transform: translateY(-1px);
            }
            100% {
                transform: translateY(0);
            }
        }

        .nav-link {
            color: var(--text-color) !important;
        }

        .product-card {
            background: var(--card-bg);
            border: none;
            box-shadow: 0 4px 12px var(--border-color);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1),
                      box-shadow 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 20px;
            overflow: hidden;
            color: var(--text-color);
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 24px var(--border-color);
        }

        .product-card .card-img-top {
            height: 280px;
            object-fit: contain;
            padding: 1.5rem;
            background-color: var(--card-bg);
            transition: transform 0.4s ease;
        }

        .product-card:hover .card-img-top {
            transform: scale(1.08);
        }

        .product-card .card-body {
            background-color: var(--card-bg);
            border-top: 1px solid var(--border-color);
            padding: 1.25rem;
        }

        .product-card .card-title {
            font-size: 1.1rem;
            margin-bottom: 0.75rem;
            font-weight: 600;
            height: 2.4em;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            color: var(--heading-color);
        }

        .product-card .card-text,
        .product-card .price,
        .text-muted,
        .price-text {
            color: var(--text-color) !important;
        }

        .price-text {
            font-weight: bold;
            font-size: 1.2rem;
            color: var(--primary-color) !important;
        }

        [data-theme="light"] .text-muted {
            color: var(--text-muted) !important;
            opacity: 0.9;
        }

        [data-theme="dark"] .text-muted {
            color: var(--text-muted) !important;
            opacity: 0.8;
        }

        .text-primary {
            color: var(--primary-color) !important;
        }

        .category-sidebar {
            background-color: var(--card-bg);
            padding: 1.5rem;
            border-radius: 20px;
            box-shadow: 0 4px 12px var(--border-color);
        }

        .category-sidebar h3 {
            color: var(--heading-color);
            font-weight: 700;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
            margin-bottom: 15px;
            position: relative;
        }

        .category-sidebar h3::after {
            content: 'üêæ';
            position: absolute;
            right: 0;
            top: 0;
            font-size: 1.2em;
            opacity: 0.7;
        }

        .category-sidebar a {
            color: var(--text-color) !important;
            transition: color 0.3s ease;
        }

        .category-sidebar a:hover {
            color: var(--primary-color) !important;
            text-decoration: none;
        }

        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            border-radius: 25px;
            padding: 0.5rem 1.5rem;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            color: white !important;
            position: relative;
            overflow: hidden;
        }

        .btn-primary:hover {
            background-color: #E85A3A;
            border-color: #E85A3A;
            transform: translateY(-2px);
            color: white !important;
            box-shadow: 0 4px 12px rgba(232, 90, 58, 0.3);
        }

        .btn-primary:active {
            background-color: #D14929 !important;
            border-color: #D14929 !important;
            transform: translateY(1px) !important;
            box-shadow: 0 2px 6px rgba(209, 73, 41, 0.4) !important;
        }

        .btn-outline-primary {
            color: var(--primary-color) !important;
            border-color: var(--primary-color);
            background-color: transparent;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 25px;
            padding: 0.5rem 1.5rem;
            font-weight: 600;
        }

        .btn-outline-primary:hover {
            color: white !important;
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(232, 90, 58, 0.2);
        }

        .btn-outline-primary:active {
            background-color: #D14929 !important;
            border-color: #D14929 !important;
            transform: translateY(1px) !important;
            box-shadow: 0 2px 6px rgba(209, 73, 41, 0.3) !important;
        }

        /* Success button (Proceed to Checkout) */
        .btn-success {
            background-color: #2ecc71;
            border-color: #2ecc71;
            color: white !important;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 25px;
            padding: 0.5rem 1.5rem;
            font-weight: 600;
        }

        .btn-success:hover {
            background-color: #27ae60;
            border-color: #27ae60;
            color: white !important;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(46, 204, 113, 0.3);
        }

        .btn-success:active {
            background-color: #219a52 !important;
            border-color: #219a52 !important;
            transform: translateY(1px) !important;
            box-shadow: 0 2px 6px rgba(33, 154, 82, 0.4) !important;
        }

        /* Button focus states */
        .btn:focus {
            box-shadow: none !important;
        }

        .btn-primary:focus {
            box-shadow: 0 0 0 3px rgba(255, 107, 74, 0.3) !important;
        }

        .btn-outline-primary:focus {
            box-shadow: 0 0 0 3px rgba(255, 107, 74, 0.2) !important;
        }

        .btn-success:focus {
            box-shadow: 0 0 0 3px rgba(46, 204, 113, 0.3) !important;
        }

        /* Dark theme button adjustments */
        [data-theme="dark"] .btn-primary:hover {
            box-shadow: 0 4px 12px rgba(232, 90, 58, 0.4);
        }

        [data-theme="dark"] .btn-outline-primary {
            border-color: var(--primary-color);
        }

        [data-theme="dark"] .btn-outline-primary:hover {
            box-shadow: 0 4px 12px rgba(232, 90, 58, 0.3);
        }

        [data-theme="dark"] .btn-success:hover {
            box-shadow: 0 4px 12px rgba(46, 204, 113, 0.4);
        }

        /* Button states */
        .btn:active,
        .btn:focus {
            box-shadow: 0 0 0 0.2rem rgba(255, 107, 74, 0.25) !important;
        }

        .btn-success:active,
        .btn-success:focus {
            box-shadow: 0 0 0 0.2rem rgba(46, 204, 113, 0.25) !important;
        }

        .heading-container {
            text-align: center;
            width: 100%;
            margin: 2rem 0;
            position: relative;
        }

        .japanese-heading {
            font-family: 'Noto Sans JP', sans-serif;
            color: var(--heading-color);
            font-weight: 700;
            text-align: center;
            margin: 0 auto;
            position: relative;
            display: inline-block;
            padding: 0 4em;
        }

        .japanese-heading::before,
        .japanese-heading::after {
            content: 'üêº';
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2em;
            opacity: 0.7;
            padding: 0 0.5em;
        }

        .japanese-heading::before {
            left: 0;
        }

        .japanese-heading::after {
            right: 0;
        }

        .cart-container {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 4px 12px var(--border-color);
        }

        .cart-image {
            width: 100px;
            height: 100px;
            object-fit: contain;
            border-radius: 12px;
            padding: 0.5rem;
            background-color: var(--card-bg);
            transition: transform 0.3s ease;
        }

        .cart-image:hover {
            transform: scale(1.05);
        }

        .cart-table {
            color: var(--text-color);
            border-color: var(--border-color);
            background-color: var(--card-bg);
        }

        .cart-table tbody {
            background-color: var(--card-bg);
        }

        .cart-table th {
            border-bottom: 2px solid var(--border-color);
            padding: 1rem;
            font-weight: 600;
            color: var(--heading-color);
            background-color: var(--card-bg);
        }

        .cart-table td {
            border-color: var(--border-color);
            padding: 1rem;
            vertical-align: middle;
            background-color: var(--card-bg);
        }

        .cart-table tr:hover td {
            background-color: var(--hover-color);
        }

        [data-theme="dark"] .cart-table {
            border-color: var(--border-color);
        }

        [data-theme="dark"] .cart-table td,
        [data-theme="dark"] .cart-table th {
            border-color: var(--border-color);
        }

        [data-theme="dark"] .table {
            --bs-table-bg: var(--card-bg);
            --bs-table-striped-bg: var(--card-bg);
            --bs-table-hover-bg: var(--hover-color);
        }

        .cart-actions {
            margin-top: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background-color: var(--background-color);
            border-radius: 15px;
            box-shadow: 0 2px 8px var(--border-color);
        }

        .empty-cart {
            text-align: center;
            padding: 3rem;
            background-color: var(--background-color);
            border-radius: 20px;
            margin: 2rem 0;
            color: var(--text-muted);
        }

        .empty-cart i {
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
            opacity: 0.9;
        }

        .cart-quantity {
            width: 80px;
            padding: 0.375rem 0.75rem;
            font-size: 1rem;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            background-color: var(--card-bg);
            color: var(--text-color);
            transition: all 0.15s ease !important;
        }

        .cart-quantity:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 0.2rem rgba(255, 107, 74, 0.25);
            background-color: var(--card-bg);
            color: var(--text-color);
        }

        .cart-remove {
            color: var(--primary-color);
            background: none;
            border: none;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .cart-remove:hover {
            background-color: var(--hover-color);
            transform: scale(1.1);
        }

        .cart-total {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary-color);
            text-shadow: 0 0 1px var(--border-color);
            transition: color 0.3s ease;
        }

        [data-theme="dark"] .cart-total,
        [data-theme="dark"] .cart-actions .cart-total {
            color: white !important;
            text-shadow: none;
        }

        .nav-cart-icon {
            position: relative;
            padding: 0.5rem;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .nav-cart-icon:hover {
            background-color: var(--hover-color);
            transform: scale(1.1);
        }

        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            padding: 2px 6px;
            font-size: 0.8rem;
            font-weight: bold;
            border: 2px solid var(--card-bg);
            transition: all 0.3s ease;
        }

        .nav-cart-icon:hover .cart-count {
            transform: scale(1.1);
        }

        footer {
            background-color: var(--card-bg);
            color: var(--text-muted);
            border-top: 1px solid var(--border-color);
        }

        .theme-switch {
            position: relative;
            width: 60px;
            height: 30px;
            margin: 0 15px;
        }

        .theme-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--primary-color);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 30px;
            overflow: hidden;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary-color);
        }

        input:checked + .slider:before {
            transform: translateX(30px);
        }

        .theme-icon {
            color: var(--text-color);
            font-size: 1.2rem;
            margin: 0 5px;
            transition: all 0.4s ease;
        }

        /* Update transition properties for smooth theme switching */
        *, *::before, *::after {
            transition: background-color 0.3s ease,
                      color 0.2s ease,
                      border-color 0.3s ease,
                      box-shadow 0.3s ease,
                      opacity 0.2s ease !important;
        }

        /* Text-specific transitions */
        .product-description,
        .product-description p,
        .card-title,
        .text-muted,
        .price-text,
        p,
        h1, h2, h3, h4, h5, h6,
        .description-heading,
        .input-group-text {
            transition: color 0.15s ease !important;
            transition-delay: 0s !important;
        }

        /* Override any other transitions for text elements */
        .product-description *,
        .product-description p,
        .product-description span {
            transition: color 0.15s ease !important;
            transition-delay: 0s !important;
        }

        /* Form elements in dark mode */
        [data-theme="dark"] input,
        [data-theme="dark"] select,
        [data-theme="dark"] textarea,
        [data-theme="dark"] .form-control,
        [data-theme="dark"] .input-group-text {
            background-color: var(--card-bg);
            color: var(--text-color);
            border-color: var(--border-color);
        }

        [data-theme="dark"] input:focus,
        [data-theme="dark"] select:focus,
        [data-theme="dark"] textarea:focus,
        [data-theme="dark"] .form-control:focus {
            background-color: var(--background-color);
            color: var(--text-color);
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(255, 107, 74, 0.25);
        }

        /* Specific transitions for interactive elements */
        .nav-link,
        .product-link,
        .cart-table,
        .japanese-heading,
        .category-sidebar a,
        .cart-total,
        .btn,
        a,
        .cart-quantity,
        .cart-remove,
        .theme-icon,
        .slider,
        .product-card,
        .cart-image,
        .empty-cart {
            transition: all 0.3s ease !important;
        }

        /* Theme transition animation */
        .theme-transition {
            animation: themeTransition 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes themeTransition {
            0% {
                opacity: 0.95;
                transform: scale(0.98);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Smooth transform transitions */
        .product-card:hover,
        .cart-remove:hover,
        .nav-cart-icon:hover,
        .btn:hover,
        .navbar-brand:hover img,
        .cart-image:hover {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                      box-shadow 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        }

        /* Theme icons transition */
        [data-theme="dark"] #lightIcon,
        [data-theme="light"] #darkIcon {
            transition: opacity 0.3s ease,
                      transform 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        }

        /* Form elements transition */
        input,
        select,
        textarea,
        .form-control,
        .input-group-text {
            transition: background-color 0.3s ease,
                      color 0.3s ease,
                      border-color 0.3s ease,
                      box-shadow 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        }

        /* Card and container transitions */
        .product-card,
        .cart-container,
        .category-sidebar,
        .empty-cart,
        .cart-actions {
            transition: background-color 0.3s ease,
                      box-shadow 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                      transform 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        }

        /* Mobile responsive cart styles */
        @media (max-width: 768px) {
            .cart-container {
                padding: 1rem;
            }

            .cart-table {
                display: block;
                width: 100%;
            }

            .cart-table thead {
                display: none;
            }

            .cart-table tbody,
            .cart-table tr,
            .cart-table td {
                display: block;
                width: 100%;
            }

            .cart-table tr {
                background-color: var(--card-bg);
                margin-bottom: 1rem;
                padding: 1rem;
                border-radius: 15px;
                box-shadow: 0 2px 4px var(--border-color);
            }

            .cart-table td {
                text-align: right;
                padding: 0.5rem 0;
                border: none;
                position: relative;
                padding-left: 50%;
            }

            .cart-table td::before {
                content: attr(data-label);
                position: absolute;
                left: 0;
                width: 45%;
                text-align: left;
                font-weight: 600;
                color: var(--heading-color);
            }

            .cart-image {
                width: 120px;
                height: 120px;
                margin: 0 auto;
                display: block;
            }

            .cart-actions {
                flex-direction: column;
                gap: 1rem;
            }

            .cart-actions .btn {
                width: 100%;
                padding: 0.75rem;
            }

            .total-row td {
                text-align: center;
                padding: 1rem;
                font-size: 1.2rem;
                font-weight: 600;
            }

            [data-theme="dark"] .total-row td::before {
                color: var(--text-muted);
            }

            .cart-remove {
                margin: 0 auto;
                display: block;
            }

            .product-link {
                display: block;
                text-align: center;
                margin-bottom: 0.5rem;
                font-size: 1.1rem;
            }
        }

        /* Mobile responsive styles */
        @media (max-width: 768px) {
            /* General layout */
            .container {
                padding: 0.5rem;
            }

            /* Navbar */
            .navbar {
                padding: 0.75rem;
            }

            .navbar-brand {
                font-size: 1.4rem;
            }

            .navbar-brand img {
                width: 32px;
                height: 32px;
            }

            /* Product cards */
            .product-card {
                margin-bottom: 1rem;
            }

            .product-card .card-img-top {
                height: 220px;
                padding: 1rem;
            }

            .product-card .card-body {
                padding: 1rem;
            }

            .product-card .card-title {
                font-size: 1rem;
                height: auto;
                margin-bottom: 0.5rem;
            }

            /* Category sidebar */
            .category-sidebar {
                margin-bottom: 1.5rem;
                position: relative;
                z-index: 1;
            }

            /* Product detail page */
            .product-detail-image {
                margin-bottom: 1.5rem;
            }

            .japanese-heading {
                font-size: 1.5rem;
                padding: 0 3em;
            }

            .description-heading {
                font-size: 1.2rem;
            }

            .price-text {
                font-size: 1.4rem;
            }

            .add-to-cart-form .btn {
                width: 100%;
                margin-top: 1rem;
            }

            .input-group {
                width: 100% !important;
                max-width: none !important;
            }

            /* Buttons */
            .btn {
                padding: 0.6rem 1.2rem;
                font-size: 1rem;
            }

            .btn-lg {
                padding: 0.8rem 1.5rem;
                font-size: 1.1rem;
            }

            /* Footer */
            footer {
                padding: 1.5rem 0;
                text-align: center;
                font-size: 0.9rem;
            }

            /* Theme switch */
            .theme-switch {
                margin: 0 10px;
            }

            .theme-icon {
                font-size: 1rem;
            }

            /* Empty states */
            .empty-cart {
                padding: 2rem 1rem;
            }

            .empty-cart i {
                font-size: 2.5rem;
            }

            /* Product grid */
            .row {
                margin-right: -0.5rem;
                margin-left: -0.5rem;
            }

            .col-md-4, .col-md-6, .col-md-3 {
                padding-right: 0.5rem;
                padding-left: 0.5rem;
            }

            /* Quantity inputs */
            input[type="number"] {
                font-size: 1rem;
                padding: 0.5rem;
            }

            /* Navigation spacing */
            .nav-item {
                margin: 0.5rem 0;
            }

            /* Cart icon */
            .nav-cart-icon {
                padding: 0.4rem;
            }

            .cart-count {
                font-size: 0.7rem;
                padding: 1px 5px;
            }
        }

        /* Small mobile devices */
        @media (max-width: 576px) {
            .container {
                padding: 0.25rem;
            }

            .japanese-heading {
                font-size: 1.3rem;
                padding: 0 3.5em;
            }

            .japanese-heading::before,
            .japanese-heading::after {
                padding: 0 0.7em;
            }

            .product-card .card-img-top {
                height: 180px;
            }

            .btn {
                padding: 0.5rem 1rem;
                font-size: 0.9rem;
            }

            .cart-container {
                padding: 0.5rem;
            }

            .cart-image {
                width: 100px;
                height: 100px;
            }

            .price-text {
                font-size: 1.2rem;
            }

            footer {
                padding: 1rem 0;
                font-size: 0.8rem;
            }
        }

        /* Navbar styles */
        .navbar {
            background-color: var(--card-bg) !important;
            box-shadow: 0 2px 8px var(--border-color);
            padding: 0.5rem 1rem;
        }

        .navbar-brand {
            font-family: 'Noto Sans JP', sans-serif;
            font-weight: 700;
            color: var(--primary-color) !important;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Navbar toggler styles */
        .navbar-toggler {
            border-color: var(--border-color);
            background-color: transparent;
            padding: 0.5rem;
            transition: border-color 0.15s ease;
        }

        .navbar-toggler:focus {
            box-shadow: 0 0 0 0.2rem rgba(255, 107, 74, 0.25);
        }

        [data-theme="dark"] .navbar-toggler-icon {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba(255, 255, 255, 0.75)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
        }

        [data-theme="light"] .navbar-toggler-icon {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba(0, 0, 0, 0.75)' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
        }

        [data-theme="dark"] .navbar-toggler {
            border-color: var(--border-color);
        }

        [data-theme="dark"] .navbar-toggler:focus {
            box-shadow: 0 0 0 0.2rem rgba(255, 107, 74, 0.25);
        }

        /* Global link styles */
        a {
            color: var(--primary-color) !important;
            text-decoration: none;
            transition: color 0.15s ease, opacity 0.15s ease;
        }

        a:hover {
            color: #E85A3A !important;
            text-decoration: none;
            opacity: 0.9;
        }

        /* Category links */
        .category-sidebar a {
            color: var(--text-color) !important;
            transition: color 0.15s ease;
        }

        .category-sidebar a:hover {
            color: var(--primary-color) !important;
        }

        /* Product links */
        .product-link {
            color: var(--text-color) !important;
            transition: color 0.15s ease;
            font-weight: 500;
        }

        .product-link:hover {
            color: var(--primary-color) !important;
        }

        /* Navigation links */
        .nav-link {
            color: var(--text-color) !important;
            transition: color 0.15s ease;
        }

        .nav-link:hover {
            color: var(--primary-color) !important;
        }

        /* Button links */
        .btn-link {
            color: var(--primary-color) !important;
            text-decoration: none;
        }

        .btn-link:hover {
            color: #E85A3A !important;
            text-decoration: none;
        }

        /* Category text in product detail */
        .text-muted a {
            color: var(--text-muted) !important;
            transition: color 0.15s ease;
        }

        .text-muted a:hover {
            color: var(--primary-color) !important;
        }

        /* Cart price text */
        .cart-table td[data-label="Unit Price"],
        .cart-table td[data-label="Total Price"],
        .cart-table td[data-label="Price"],
        .cart-table td[data-label="Quantity"],
        .total-row td {
            color: var(--text-color) !important;
            transition: color 0.15s ease !important;
        }

        /* Cart total row */
        .total-row td {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--primary-color) !important;
            transition: color 0.3s ease;
        }

        [data-theme="dark"] .total-row td {
            color: white !important;
        }

        [data-theme="dark"] .total-row td[data-label="Total"] {
            color: white !important;
        }

        /* Dark theme specific cart styles */
        [data-theme="dark"] .cart-quantity {
            background-color: var(--card-bg);
            color: var(--text-color);
            border-color: var(--border-color);
        }

        [data-theme="dark"] .cart-quantity:focus {
            background-color: var(--background-color);
            color: var(--text-color);
            border-color: var(--primary-color);
        }

        [data-theme="dark"] .cart-table td[data-label="Unit Price"],
        [data-theme="dark"] .cart-table td[data-label="Total Price"],
        [data-theme="dark"] .cart-table td[data-label="Price"],
        [data-theme="dark"] .cart-table td[data-label="Quantity"] {
            color: var(--text-color) !important;
        }

        [data-theme="dark"] .total-row td {
            color: var(--primary-color) !important;
        }

        /* Categories Slider Styles */
        .categories-slider-container {
            position: relative;
            width: 100%;
            overflow: hidden;
            padding: 0 40px;
        }

        .categories-slider {
            display: flex;
            overflow-x: auto;
            scroll-behavior: smooth;
            scrollbar-width: none;
            -ms-overflow-style: none;
            gap: 1rem;
            padding: 0.5rem 0;
        }

        .categories-slider::-webkit-scrollbar {
            display: none;
        }

        .category-item {
            flex: 0 0 auto;
        }

        .category-card {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            box-shadow: 0 2px 8px var(--border-color);
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .category-card i {
            font-size: 1.2rem;
            color: var(--primary-color);
            transition: transform 0.3s ease;
        }

        .category-card span {
            color: var(--text-color);
            font-weight: 500;
            white-space: nowrap;
        }

        .category-link {
            text-decoration: none;
        }

        .category-item.active .category-card {
            background-color: var(--primary-color);
        }

        .category-item.active .category-card i,
        .category-item.active .category-card span {
            color: white !important;
        }

        .category-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--border-color);
        }

        .category-card:hover i {
            transform: scale(1.1);
        }

        .slider-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--card-bg);
            border: none;
            box-shadow: 0 2px 8px var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 2;
        }

        .slider-nav.prev {
            left: 0;
        }

        .slider-nav.next {
            right: 0;
        }

        .slider-nav i {
            color: var(--primary-color);
            font-size: 0.9rem;
        }

        .slider-nav:hover {
            background-color: var(--primary-color);
            transform: translateY(-50%) scale(1.1);
        }

        .slider-nav:hover i {
            color: white;
        }

        @media (max-width: 768px) {
            .categories-slider-container {
                padding: 0 35px;
            }

            .category-card {
                padding: 0.75rem 1.25rem;
                min-width: 100px;
            }

            .category-card i {
                font-size: 1rem;
            }

            .category-card span {
                font-size: 0.9rem;
            }

            .slider-nav {
                width: 32px;
                height: 32px;
            }
        }

        .theme-toggle-btn {
            background: linear-gradient(135deg, var(--primary-color) 0%, #ffb347 100%);
            border: 2px solid rgba(255,255,255,0.18);
            color: #fff;
            font-size: 1.35rem;
            padding: 0.35rem 0.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            box-shadow: 0 2px 8px 0 #ffb34755, 0 0 0 0 var(--primary-color);
            transition: background 0.3s, color 0.2s, box-shadow 0.3s, filter 0.2s, border 0.3s;
            outline: none;
            position: relative;
            z-index: 2;
        }
        .theme-toggle-btn:hover {
            box-shadow: 0 0 10px 2px var(--primary-color), 0 2px 8px #ffb34799;
            filter: brightness(1.08) saturate(1.2);
            border: 2px solid var(--accent-color);
        }
        .theme-toggle-btn:active {
            filter: brightness(0.95) saturate(0.9);
            box-shadow: 0 1px 4px #ffb34755;
        }
        .theme-toggle-btn .fa-sun, .theme-toggle-btn .fa-moon {
            transition: color 0.2s;
            font-size: 1.25rem;
            text-shadow: 0 0 4px #fff7, 0 0 1px #ffb34799;
        }
        .theme-toggle-btn .icon-rotate {
            animation: icon-rotate-anim 0.5s cubic-bezier(.68,-0.55,.27,1.55);
        }
        @keyframes icon-rotate-anim {
            0% { transform: rotate(0deg); }
            60% { transform: rotate(160deg) scale(1.12); }
            80% { transform: rotate(185deg) scale(1.08); }
            100% { transform: rotate(180deg) scale(1); }
        }

        @media (max-width: 992px) {
            .navbar .navbar-toggler {
                display: none !important;
            }
            .navbar .collapse,
            .navbar .navbar-nav {
                display: none !important;
            }
            .navbar .navbar-brand {
                margin-left: auto;
                margin-right: auto;
                display: flex;
                align-items: center;
                justify-content: center;
                width: 100%;
            }
            .bottom-nav {
                display: flex !important;
                position: fixed;
                left: 0;
                right: 0;
                bottom: 0;
                z-index: 1050;
                background: var(--card-bg);
                box-shadow: 0 -2px 12px var(--border-color);
                justify-content: space-around;
                align-items: center;
                padding: 0.15rem 0 0.1rem 0;
                border-top: 1.5px solid var(--border-color);
                height: 48px;
            }
            .bottom-nav .nav-icon-btn {
                background: none;
                border: none;
                outline: none;
                color: var(--text-color);
                font-size: 1.45rem;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 0.1rem 0.5rem 0.1rem 0.5rem;
                border-radius: 10px;
                transition: background 0.2s, color 0.2s;
                min-width: 44px;
                min-height: 44px;
            }
            .bottom-nav .nav-icon-btn.active,
            .bottom-nav .nav-icon-btn:focus,
            .bottom-nav .nav-icon-btn:hover {
                background: var(--hover-color);
                color: var(--primary-color);
            }
            .bottom-nav .theme-toggle-btn {
                font-size: 1.25rem;
                padding: 0.1rem 0.5rem;
                box-shadow: none;
                border: none;
                background: none;
            }
            body { padding-bottom: 52px !important; }
        }
        @media (min-width: 993px) {
            .navbar .navbar-brand {
                margin-left: 0;
                margin-right: 0;
                justify-content: flex-start;
            }
            .bottom-nav { display: none !important; }
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light">
        <div class="container">
            <a class="navbar-brand" href="{% url 'shop:product_list' %}">
                <img src="{% static 'images/red_panda.png' %}" alt="Red Panda Logo">
                „É¨„Ç™„Éã„Çπ
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'accounts:profile' %}">
                            <i class="fas fa-user"></i>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'cart:cart_detail' %}">
                            <i class="fas fa-shopping-cart"></i>
                            {% with total_items=cart|length %}
                                {% if total_items > 0 %}
                                    <span class="badge bg-primary">{{ total_items }}</span>
                                {% endif %}
                            {% endwith %}
                        </a>
                    </li>
                    <li class="nav-item d-flex align-items-center">
                        <button type="button" class="theme-toggle-btn ms-2" id="theme-toggle" title="–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É">
                            <i id="themeIcon" class="fas fa-sun"></i>
                        </button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container">
        {% block content %}
        {% endblock %}
    </div>

    <footer class="mt-5 py-4">
        <div class="container text-center">
            <p>¬© 2024 „É¨„Ç™„Éã„Çπ Anime Shop. All rights reserved.</p>
        </div>
    </footer>

    <nav class="bottom-nav d-lg-none">
        <a href="{% url 'shop:product_list' %}" class="nav-icon-btn{% if request.resolver_match.url_name == 'product_list' %} active{% endif %}">
            <i class="fas fa-store"></i>
        </a>
        <a href="{% url 'cart:cart_detail' %}" class="nav-icon-btn{% if request.resolver_match.url_name == 'cart_detail' %} active{% endif %}">
            <i class="fas fa-shopping-cart"></i>
        </a>
        <a href="{% url 'accounts:profile' %}" class="nav-icon-btn{% if request.resolver_match.url_name == 'profile' %} active{% endif %}">
            <i class="fas fa-user"></i>
        </a>
        <button type="button" class="theme-toggle-btn nav-icon-btn" id="theme-toggle-bottom" title="–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É">
            <i id="themeIconBottom" class="fas fa-sun"></i>
        </button>
    </nav>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const themeToggle = document.getElementById('theme-toggle');
            const themeIcon = document.getElementById('themeIcon');
            function setTheme(theme) {
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('theme', theme);
                themeIcon.className = theme === 'dark' ? 'fas fa-moon' : 'fas fa-sun';
            }
            themeToggle.addEventListener('click', function() {
                themeIcon.classList.add('icon-rotate');
                setTimeout(() => themeIcon.classList.remove('icon-rotate'), 500);
                const currentTheme = document.documentElement.getAttribute('data-theme');
                setTheme(currentTheme === 'dark' ? 'light' : 'dark');
            });
            // –ò–∫–æ–Ω–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            const savedTheme = localStorage.getItem('theme') || 'light';
            themeIcon.className = savedTheme === 'dark' ? 'fas fa-moon' : 'fas fa-sun';

            // –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é: —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ç–µ–º—ã
            const themeToggleBottom = document.getElementById('theme-toggle-bottom');
            const themeIconBottom = document.getElementById('themeIconBottom');
            function setThemeBottom(theme) {
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('theme', theme);
                themeIconBottom.className = theme === 'dark' ? 'fas fa-moon' : 'fas fa-sun';
                // —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º –≤–µ—Ä—Ö–Ω—é—é –∏–∫–æ–Ω–∫—É
                if (window.themeIcon) themeIcon.className = themeIconBottom.className;
            }
            if (themeToggleBottom) {
                themeToggleBottom.addEventListener('click', function() {
                    themeIconBottom.classList.add('icon-rotate');
                    setTimeout(() => themeIconBottom.classList.remove('icon-rotate'), 500);
                    const currentTheme = document.documentElement.getAttribute('data-theme');
                    setThemeBottom(currentTheme === 'dark' ? 'light' : 'dark');
                });
                // –ò–∫–æ–Ω–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
                const savedThemeBottom = localStorage.getItem('theme') || 'light';
                themeIconBottom.className = savedThemeBottom === 'dark' ? 'fas fa-moon' : 'fas fa-sun';
            }
        });
    </script>
</body>
</html> 